{
  "asyncapi": "3.0.0",
  "info": {
    "title": "Order Processing API",
    "version": "1.0.0",
    "description": "Type-safe AMQP messaging API for order processing and notifications",
    "contact": { "name": "API Support", "email": "support@example.com" },
    "license": { "name": "MIT" }
  },
  "servers": {
    "development": {
      "host": "localhost:5672",
      "protocol": "amqp",
      "description": "Development RabbitMQ server"
    },
    "staging": {
      "host": "rabbitmq-staging.example.com:5672",
      "protocol": "amqp",
      "description": "Staging RabbitMQ server"
    },
    "production": {
      "host": "rabbitmq.example.com:5672",
      "protocol": "amqp",
      "description": "Production RabbitMQ server"
    }
  },
  "channels": {
    "orderProcessing": {
      "address": "order-processing",
      "title": "order-processing",
      "description": "AMQP Queue: order-processing (bound to exchange 'orders' with routing key 'order.created')",
      "bindings": {
        "amqp": {
          "is": "queue",
          "queue": {
            "name": "order-processing",
            "durable": true,
            "exclusive": false,
            "autoDelete": false,
            "vhost": "/"
          },
          "bindingVersion": "0.3.0"
        }
      },
      "messages": {
        "processOrderMessage": {
          "payload": {
            "type": "object",
            "properties": {
              "orderId": { "type": "string" },
              "customerId": { "type": "string" },
              "items": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "productId": { "type": "string" },
                    "quantity": {
                      "type": "integer",
                      "minimum": -9007199254740991,
                      "maximum": 9007199254740991,
                      "exclusiveMinimum": 0
                    },
                    "price": { "type": "number", "exclusiveMinimum": 0 }
                  },
                  "required": ["productId", "quantity", "price"]
                }
              },
              "totalAmount": { "type": "number", "exclusiveMinimum": 0 },
              "createdAt": { "type": "string", "format": "date-time" }
            },
            "required": ["orderId", "customerId", "items", "totalAmount", "createdAt"]
          },
          "contentType": "application/json",
          "summary": "Order created event",
          "description": "Emitted when a new order is created in the system"
        }
      }
    },
    "orderNotifications": {
      "address": "order-notifications",
      "title": "order-notifications",
      "description": "AMQP Queue: order-notifications (bound to exchange 'orders' with routing key 'order.created')",
      "bindings": {
        "amqp": {
          "is": "queue",
          "queue": {
            "name": "order-notifications",
            "durable": true,
            "exclusive": false,
            "autoDelete": false,
            "vhost": "/"
          },
          "bindingVersion": "0.3.0"
        }
      },
      "messages": {
        "notifyOrderMessage": {
          "payload": {
            "type": "object",
            "properties": {
              "orderId": { "type": "string" },
              "customerId": { "type": "string" },
              "items": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "productId": { "type": "string" },
                    "quantity": {
                      "type": "integer",
                      "minimum": -9007199254740991,
                      "maximum": 9007199254740991,
                      "exclusiveMinimum": 0
                    },
                    "price": { "type": "number", "exclusiveMinimum": 0 }
                  },
                  "required": ["productId", "quantity", "price"]
                }
              },
              "totalAmount": { "type": "number", "exclusiveMinimum": 0 },
              "createdAt": { "type": "string", "format": "date-time" }
            },
            "required": ["orderId", "customerId", "items", "totalAmount", "createdAt"]
          },
          "contentType": "application/json",
          "summary": "Order created event",
          "description": "Emitted when a new order is created in the system"
        }
      }
    },
    "emailNotifications": {
      "address": "email-notifications",
      "title": "email-notifications",
      "description": "AMQP Queue: email-notifications (bound to exchange 'notifications')",
      "bindings": {
        "amqp": {
          "is": "queue",
          "queue": {
            "name": "email-notifications",
            "durable": true,
            "exclusive": false,
            "autoDelete": false,
            "vhost": "/"
          },
          "bindingVersion": "0.3.0"
        }
      },
      "messages": {
        "sendEmailMessage": {
          "payload": {
            "type": "object",
            "properties": {
              "notificationId": { "type": "string" },
              "recipientId": { "type": "string" },
              "type": { "enum": ["email", "sms", "push"] },
              "subject": { "type": "string" },
              "message": { "type": "string" },
              "sentAt": { "type": "string", "format": "date-time" }
            },
            "required": ["notificationId", "recipientId", "type", "subject", "message", "sentAt"]
          },
          "contentType": "application/json",
          "summary": "Notification sent event",
          "description": "Emitted when a notification is sent to a user"
        }
      }
    },
    "orders": {
      "address": "orders",
      "title": "orders",
      "description": "AMQP Exchange: orders (topic)",
      "bindings": {
        "amqp": {
          "is": "routingKey",
          "exchange": {
            "name": "orders",
            "type": "topic",
            "durable": true,
            "autoDelete": false,
            "vhost": "/"
          },
          "bindingVersion": "0.3.0"
        }
      },
      "messages": {
        "orderCreatedMessage": {
          "payload": {
            "type": "object",
            "properties": {
              "orderId": { "type": "string" },
              "customerId": { "type": "string" },
              "items": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "productId": { "type": "string" },
                    "quantity": {
                      "type": "integer",
                      "minimum": -9007199254740991,
                      "maximum": 9007199254740991,
                      "exclusiveMinimum": 0
                    },
                    "price": { "type": "number", "exclusiveMinimum": 0 }
                  },
                  "required": ["productId", "quantity", "price"]
                }
              },
              "totalAmount": { "type": "number", "exclusiveMinimum": 0 },
              "createdAt": { "type": "string", "format": "date-time" }
            },
            "required": ["orderId", "customerId", "items", "totalAmount", "createdAt"]
          },
          "contentType": "application/json",
          "summary": "Order created event",
          "description": "Emitted when a new order is created in the system"
        }
      }
    },
    "notifications": {
      "address": "notifications",
      "title": "notifications",
      "description": "AMQP Exchange: notifications (fanout)",
      "bindings": {
        "amqp": {
          "is": "routingKey",
          "exchange": {
            "name": "notifications",
            "type": "fanout",
            "durable": true,
            "autoDelete": false,
            "vhost": "/"
          },
          "bindingVersion": "0.3.0"
        }
      },
      "messages": {
        "notificationSentMessage": {
          "payload": {
            "type": "object",
            "properties": {
              "notificationId": { "type": "string" },
              "recipientId": { "type": "string" },
              "type": { "enum": ["email", "sms", "push"] },
              "subject": { "type": "string" },
              "message": { "type": "string" },
              "sentAt": { "type": "string", "format": "date-time" }
            },
            "required": ["notificationId", "recipientId", "type", "subject", "message", "sentAt"]
          },
          "contentType": "application/json",
          "summary": "Notification sent event",
          "description": "Emitted when a notification is sent to a user"
        }
      }
    }
  },
  "operations": {
    "orderCreated": {
      "action": "send",
      "channel": { "$ref": "#/channels/orders" },
      "messages": [{ "$ref": "#/channels/orders/messages/orderCreatedMessage" }],
      "summary": "Publish to orders",
      "description": "Routing key: order.created",
      "bindings": {
        "amqp": { "cc": ["order.created"], "deliveryMode": 2, "bindingVersion": "0.3.0" }
      }
    },
    "notificationSent": {
      "action": "send",
      "channel": { "$ref": "#/channels/notifications" },
      "messages": [{ "$ref": "#/channels/notifications/messages/notificationSentMessage" }],
      "summary": "Publish to notifications"
    },
    "processOrder": {
      "action": "receive",
      "channel": { "$ref": "#/channels/orderProcessing" },
      "messages": [{ "$ref": "#/channels/orderProcessing/messages/processOrderMessage" }],
      "summary": "Consume from order-processing",
      "bindings": { "amqp": { "bindingVersion": "0.3.0" } }
    },
    "notifyOrder": {
      "action": "receive",
      "channel": { "$ref": "#/channels/orderNotifications" },
      "messages": [{ "$ref": "#/channels/orderNotifications/messages/notifyOrderMessage" }],
      "summary": "Consume from order-notifications",
      "bindings": { "amqp": { "bindingVersion": "0.3.0" } }
    },
    "sendEmail": {
      "action": "receive",
      "channel": { "$ref": "#/channels/emailNotifications" },
      "messages": [{ "$ref": "#/channels/emailNotifications/messages/sendEmailMessage" }],
      "summary": "Consume from email-notifications",
      "bindings": { "amqp": { "bindingVersion": "0.3.0" } }
    }
  },
  "components": {
    "messages": {
      "processOrderMessage": {
        "payload": {
          "type": "object",
          "properties": {
            "orderId": { "type": "string" },
            "customerId": { "type": "string" },
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "productId": { "type": "string" },
                  "quantity": {
                    "type": "integer",
                    "minimum": -9007199254740991,
                    "maximum": 9007199254740991,
                    "exclusiveMinimum": 0
                  },
                  "price": { "type": "number", "exclusiveMinimum": 0 }
                },
                "required": ["productId", "quantity", "price"]
              }
            },
            "totalAmount": { "type": "number", "exclusiveMinimum": 0 },
            "createdAt": { "type": "string", "format": "date-time" }
          },
          "required": ["orderId", "customerId", "items", "totalAmount", "createdAt"]
        },
        "contentType": "application/json",
        "summary": "Order created event",
        "description": "Emitted when a new order is created in the system"
      },
      "notifyOrderMessage": {
        "payload": {
          "type": "object",
          "properties": {
            "orderId": { "type": "string" },
            "customerId": { "type": "string" },
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "productId": { "type": "string" },
                  "quantity": {
                    "type": "integer",
                    "minimum": -9007199254740991,
                    "maximum": 9007199254740991,
                    "exclusiveMinimum": 0
                  },
                  "price": { "type": "number", "exclusiveMinimum": 0 }
                },
                "required": ["productId", "quantity", "price"]
              }
            },
            "totalAmount": { "type": "number", "exclusiveMinimum": 0 },
            "createdAt": { "type": "string", "format": "date-time" }
          },
          "required": ["orderId", "customerId", "items", "totalAmount", "createdAt"]
        },
        "contentType": "application/json",
        "summary": "Order created event",
        "description": "Emitted when a new order is created in the system"
      },
      "sendEmailMessage": {
        "payload": {
          "type": "object",
          "properties": {
            "notificationId": { "type": "string" },
            "recipientId": { "type": "string" },
            "type": { "enum": ["email", "sms", "push"] },
            "subject": { "type": "string" },
            "message": { "type": "string" },
            "sentAt": { "type": "string", "format": "date-time" }
          },
          "required": ["notificationId", "recipientId", "type", "subject", "message", "sentAt"]
        },
        "contentType": "application/json",
        "summary": "Notification sent event",
        "description": "Emitted when a notification is sent to a user"
      },
      "orderCreatedMessage": {
        "payload": {
          "type": "object",
          "properties": {
            "orderId": { "type": "string" },
            "customerId": { "type": "string" },
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "productId": { "type": "string" },
                  "quantity": {
                    "type": "integer",
                    "minimum": -9007199254740991,
                    "maximum": 9007199254740991,
                    "exclusiveMinimum": 0
                  },
                  "price": { "type": "number", "exclusiveMinimum": 0 }
                },
                "required": ["productId", "quantity", "price"]
              }
            },
            "totalAmount": { "type": "number", "exclusiveMinimum": 0 },
            "createdAt": { "type": "string", "format": "date-time" }
          },
          "required": ["orderId", "customerId", "items", "totalAmount", "createdAt"]
        },
        "contentType": "application/json",
        "summary": "Order created event",
        "description": "Emitted when a new order is created in the system"
      },
      "notificationSentMessage": {
        "payload": {
          "type": "object",
          "properties": {
            "notificationId": { "type": "string" },
            "recipientId": { "type": "string" },
            "type": { "enum": ["email", "sms", "push"] },
            "subject": { "type": "string" },
            "message": { "type": "string" },
            "sentAt": { "type": "string", "format": "date-time" }
          },
          "required": ["notificationId", "recipientId", "type", "subject", "message", "sentAt"]
        },
        "contentType": "application/json",
        "summary": "Notification sent event",
        "description": "Emitted when a notification is sent to a user"
      }
    }
  }
}
